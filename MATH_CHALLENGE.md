# 数学挑战机制说明

## 概述

本项目已配置了代码提交前的数学挑战机制。每个要修改代码的人在提交代码前都需要回答一道大学专业数学题。

## 功能特点

- **10道精选大学数学题**：涵盖微积分、线性代数、概率论、复变函数、微分方程等
- **智能答案验证**：支持多种合理的答案格式
- **3次答题机会**：答错后提供提示，最多尝试3次
- **自动阻止提交**：答题失败则无法提交代码

## 快速开始

### 1. 初始化Git仓库（如果还没有）

```bash
git init
```

### 2. 安装Git Hooks

```bash
npm run setup-hooks
```

或者在安装依赖时会自动设置（通过postinstall脚本）：

```bash
pnpm install
```

### 3. 测试数学挑战

你可以单独运行数学挑战脚本来测试：

```bash
node scripts/math-challenge.js
```

## 使用流程

1. **修改代码**
2. **添加到暂存区**：`git add .`
3. **提交代码**：`git commit -m "your message"`
4. **回答数学题**：系统会随机抽取一道题，正确回答后才能提交成功

## 示例

```bash
$ git commit -m "更新功能"

======================================================================
🎓 代码提交前的数学挑战！
======================================================================

请回答以下大学数学题才能继续提交代码：

📚 问题: 求极限: lim(x→0) (sin(x) / x) = ?

💡 你的答案: 1

✅ 回答正确！你可以继续提交代码了。

======================================================================
```

## 题库内容

当前题库包含以下类型的数学题：

1. **极限计算**：lim(x→0) sin(x)/x
2. **导数计算**：链式法则、乘积法则
3. **定积分**：三角函数积分
4. **线性代数**：矩阵行列式
5. **概率论**：基本概率计算
6. **复变函数**：欧拉公式
7. **微分方程**：一阶微分方程通解
8. **级数**：等比级数求和
9. **向量运算**：向量的模
10. **拉普拉斯变换**：基本变换公式

## 文件结构

```
scripts/
├── math-challenge.js   # 数学题验证主脚本
├── pre-commit          # Git pre-commit hook模板
└── setup-hooks.js      # 自动安装hooks的脚本
```

## 自定义题库

如果想添加或修改数学题，编辑 `scripts/math-challenge.js` 文件中的 `mathQuestions` 数组：

```javascript
const mathQuestions = [
  {
    question: '你的问题',
    answer: '标准答案',
    acceptableAnswers: ['答案1', '答案2', '答案3'], // 可选
    hints: ['提示1', '提示2', '提示3'] // 可选
  },
  // 更多题目...
];
```

## 跳过验证（不建议）

如果确实需要跳过验证（仅用于紧急情况），可以使用：

```bash
git commit --no-verify -m "emergency fix"
```

**注意**：这违背了设置此机制的初衷，不建议使用。

## 技术实现

- **语言**：Node.js (ES Modules)
- **依赖**：仅使用Node.js内置模块（readline, fs, path）
- **工作原理**：通过Git pre-commit hook在提交前执行验证脚本

## 故障排除

### 问题：提示"不是Git仓库"

**解决**：先运行 `git init` 初始化仓库，然后运行 `npm run setup-hooks`

### 问题：hook没有执行

**解决**：
1. 检查 `.git/hooks/pre-commit` 文件是否存在
2. 检查文件是否有执行权限：`ls -la .git/hooks/pre-commit`
3. 如果没有，运行：`chmod +x .git/hooks/pre-commit`

### 问题：题目太难

**建议**：
- 仔细阅读提示
- 复习相关数学知识
- 使用3次机会充分尝试
- 实在不会可以学习正确答案后下次再提交

## 维护

定期更新题库以保持挑战性和多样性。建议每季度审查和更新题目。
