<template>
  <div class="excel-guide">
    <div class="guide-header">
      <h2>ğŸ“Š Excel åˆå­¦è€…å­¦ä¹ æŒ‡å—</h2>
      <p class="subtitle">ä»é›¶å¼€å§‹ï¼ŒæŒæ¡ Excel çš„æ ¸å¿ƒåŠŸèƒ½</p>
    </div>

    <div class="guide-content">
      <!-- ä¾§è¾¹æ å¯¼èˆª -->
      <aside class="sidebar">
        <nav class="nav-menu">
          <button
            v-for="section in sections"
            :key="section.id"
            :class="['nav-item', { active: currentSection === section.id }]"
            @click="currentSection = section.id"
          >
            <span class="icon">{{ section.icon }}</span>
            <span class="text">{{ section.title }}</span>
          </button>
        </nav>

        <div class="progress-section">
          <h4>å­¦ä¹ è¿›åº¦</h4>
          <div class="progress-bar">
            <div class="progress-fill" :style="{ width: progress + '%' }"></div>
          </div>
          <p class="progress-text">{{ completedCount }}/{{ sections.length }} ç« èŠ‚å·²å®Œæˆ</p>
        </div>
      </aside>

      <!-- ä¸»å†…å®¹åŒº -->
      <main class="main-content">
        <!-- ç« èŠ‚1: Excelç®€ä»‹ -->
        <div v-if="currentSection === 'intro'" class="section">
          <h3>ğŸ¯ ä»€ä¹ˆæ˜¯ Excelï¼Ÿ</h3>
          <div class="content-block">
            <p>Microsoft Excel æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ç”µå­è¡¨æ ¼è½¯ä»¶ï¼Œå¹¿æ³›åº”ç”¨äºæ•°æ®å¤„ç†ã€åˆ†æå’Œå¯è§†åŒ–ã€‚</p>
            <div class="feature-grid">
              <div class="feature-card">
                <div class="feature-icon">ğŸ“</div>
                <h4>æ•°æ®ç®¡ç†</h4>
                <p>é«˜æ•ˆç®¡ç†å’Œç»„ç»‡å¤§é‡æ•°æ®</p>
              </div>
              <div class="feature-card">
                <div class="feature-icon">ğŸ§®</div>
                <h4>è®¡ç®—åŠŸèƒ½</h4>
                <p>å¼ºå¤§çš„å…¬å¼å’Œå‡½æ•°ç³»ç»Ÿ</p>
              </div>
              <div class="feature-card">
                <div class="feature-icon">ğŸ“ˆ</div>
                <h4>æ•°æ®å¯è§†åŒ–</h4>
                <p>åˆ›å»ºå„ç§å›¾è¡¨å’Œå›¾å½¢</p>
              </div>
              <div class="feature-card">
                <div class="feature-icon">ğŸ”</div>
                <h4>æ•°æ®åˆ†æ</h4>
                <p>ç­›é€‰ã€æ’åºå’Œé€è§†è¡¨</p>
              </div>
            </div>
          </div>

          <div class="content-block">
            <h4>Excel çš„ä¸»è¦ç»„æˆéƒ¨åˆ†</h4>
            <ul class="styled-list">
              <li><strong>å·¥ä½œç°¿ (Workbook)ï¼š</strong>Excel æ–‡ä»¶ï¼Œå¯åŒ…å«å¤šä¸ªå·¥ä½œè¡¨</li>
              <li><strong>å·¥ä½œè¡¨ (Worksheet)ï¼š</strong>ç”±è¡Œå’Œåˆ—ç»„æˆçš„è¡¨æ ¼</li>
              <li><strong>å•å…ƒæ ¼ (Cell)ï¼š</strong>å·¥ä½œè¡¨ä¸­çš„æœ€å°å•ä½ï¼Œç”±åˆ—å­—æ¯å’Œè¡Œå·æ ‡è¯†ï¼ˆå¦‚ A1ï¼‰</li>
              <li><strong>åŠŸèƒ½åŒº (Ribbon)ï¼š</strong>é¡¶éƒ¨çš„å·¥å…·æ ï¼ŒåŒ…å«å„ç§å‘½ä»¤å’ŒåŠŸèƒ½</li>
            </ul>
          </div>
        </div>

        <!-- ç« èŠ‚2: åŸºæœ¬æ“ä½œ -->
        <div v-if="currentSection === 'basics'" class="section">
          <h3>âŒ¨ï¸ åŸºæœ¬æ“ä½œ</h3>

          <div class="content-block">
            <h4>1. é€‰æ‹©å•å…ƒæ ¼</h4>
            <div class="tips-box">
              <p><strong>å•ä¸ªå•å…ƒæ ¼ï¼š</strong>ç›´æ¥ç‚¹å‡»</p>
              <p><strong>è¿ç»­åŒºåŸŸï¼š</strong>ç‚¹å‡»å¹¶æ‹–åŠ¨ï¼Œæˆ–ä½¿ç”¨ Shift + æ–¹å‘é”®</p>
              <p><strong>å¤šä¸ªå•å…ƒæ ¼ï¼š</strong>æŒ‰ä½ Ctrl é”®ç‚¹å‡»</p>
              <p><strong>æ•´è¡Œ/æ•´åˆ—ï¼š</strong>ç‚¹å‡»è¡Œå·æˆ–åˆ—å­—æ¯</p>
            </div>
          </div>

          <div class="content-block">
            <h4>2. è¾“å…¥æ•°æ®</h4>
            <ul class="styled-list">
              <li>ç‚¹å‡»å•å…ƒæ ¼åç›´æ¥è¾“å…¥</li>
              <li>è¾“å…¥å®ŒæˆåæŒ‰ <kbd>Enter</kbd> ç§»åˆ°ä¸‹ä¸€è¡Œ</li>
              <li>æŒ‰ <kbd>Tab</kbd> ç§»åˆ°ä¸‹ä¸€åˆ—</li>
              <li>æŒ‰ <kbd>Esc</kbd> å–æ¶ˆè¾“å…¥</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>3. ç¼–è¾‘æ•°æ®</h4>
            <div class="tips-box">
              <p><strong>åŒå‡»å•å…ƒæ ¼</strong> æˆ–æŒ‰ <kbd>F2</kbd> è¿›å…¥ç¼–è¾‘æ¨¡å¼</p>
              <p><strong>å¤åˆ¶ï¼š</strong><kbd>Ctrl + C</kbd></p>
              <p><strong>ç²˜è´´ï¼š</strong><kbd>Ctrl + V</kbd></p>
              <p><strong>å‰ªåˆ‡ï¼š</strong><kbd>Ctrl + X</kbd></p>
              <p><strong>æ’¤é”€ï¼š</strong><kbd>Ctrl + Z</kbd></p>
              <p><strong>é‡åšï¼š</strong><kbd>Ctrl + Y</kbd></p>
            </div>
          </div>

          <div class="content-block">
            <h4>4. è‡ªåŠ¨å¡«å……</h4>
            <p>Excel çš„è‡ªåŠ¨å¡«å……åŠŸèƒ½å¯ä»¥å¸®ä½ å¿«é€Ÿå¡«å……æ•°æ®ï¼š</p>
            <ul class="styled-list">
              <li>è¾“å…¥æ•°å­—åºåˆ—ï¼ˆå¦‚ 1, 2ï¼‰ï¼Œé€‰ä¸­åæ‹–åŠ¨å¡«å……æŸ„ï¼Œè‡ªåŠ¨ç”Ÿæˆ 3, 4, 5...</li>
              <li>è¾“å…¥æ—¥æœŸï¼Œæ‹–åŠ¨å¡«å……æŸ„è‡ªåŠ¨ç”Ÿæˆè¿ç»­æ—¥æœŸ</li>
              <li>è¾“å…¥æ–‡æœ¬åŠ æ•°å­—ï¼ˆå¦‚"äº§å“1"ï¼‰ï¼Œæ‹–åŠ¨ç”Ÿæˆ"äº§å“2"ã€"äº§å“3"...</li>
            </ul>
          </div>
        </div>

        <!-- ç« èŠ‚3: å…¬å¼å’Œå‡½æ•° -->
        <div v-if="currentSection === 'formulas'" class="section">
          <h3>ğŸ”¢ å…¬å¼å’Œå‡½æ•°</h3>

          <div class="content-block">
            <h4>å…¬å¼åŸºç¡€</h4>
            <p>æ‰€æœ‰å…¬å¼éƒ½ä»¥ <kbd>=</kbd> å¼€å¤´ï¼Œä¾‹å¦‚ï¼š</p>
            <div class="code-example">
              <code>=A1+B1</code>  å°† A1 å’Œ B1 å•å…ƒæ ¼çš„å€¼ç›¸åŠ 
            </div>
            <div class="code-example">
              <code>=A1*B1</code>  å°† A1 å’Œ B1 å•å…ƒæ ¼çš„å€¼ç›¸ä¹˜
            </div>
          </div>

          <div class="content-block">
            <h4>å¸¸ç”¨è¿ç®—ç¬¦</h4>
            <div class="operator-grid">
              <div class="operator-item">
                <span class="op">+</span>
                <span>åŠ æ³•</span>
              </div>
              <div class="operator-item">
                <span class="op">-</span>
                <span>å‡æ³•</span>
              </div>
              <div class="operator-item">
                <span class="op">*</span>
                <span>ä¹˜æ³•</span>
              </div>
              <div class="operator-item">
                <span class="op">/</span>
                <span>é™¤æ³•</span>
              </div>
              <div class="operator-item">
                <span class="op">^</span>
                <span>å¹‚è¿ç®—</span>
              </div>
              <div class="operator-item">
                <span class="op">&</span>
                <span>è¿æ¥æ–‡æœ¬</span>
              </div>
            </div>
          </div>

          <div class="content-block">
            <h4>å¸¸ç”¨å‡½æ•°</h4>
            <div class="function-list">
              <div class="function-item">
                <div class="function-header">
                  <span class="function-name">SUM</span>
                  <span class="function-desc">æ±‚å’Œ</span>
                </div>
                <div class="function-example">
                  <code>=SUM(A1:A10)</code>
                  <p>è®¡ç®— A1 åˆ° A10 çš„æ€»å’Œ</p>
                </div>
              </div>

              <div class="function-item">
                <div class="function-header">
                  <span class="function-name">AVERAGE</span>
                  <span class="function-desc">å¹³å‡å€¼</span>
                </div>
                <div class="function-example">
                  <code>=AVERAGE(A1:A10)</code>
                  <p>è®¡ç®— A1 åˆ° A10 çš„å¹³å‡å€¼</p>
                </div>
              </div>

              <div class="function-item">
                <div class="function-header">
                  <span class="function-name">COUNT</span>
                  <span class="function-desc">è®¡æ•°</span>
                </div>
                <div class="function-example">
                  <code>=COUNT(A1:A10)</code>
                  <p>è®¡ç®—åŒ…å«æ•°å­—çš„å•å…ƒæ ¼æ•°é‡</p>
                </div>
              </div>

              <div class="function-item">
                <div class="function-header">
                  <span class="function-name">MAX / MIN</span>
                  <span class="function-desc">æœ€å¤§/æœ€å°å€¼</span>
                </div>
                <div class="function-example">
                  <code>=MAX(A1:A10)</code>
                  <p>è¿”å›æœ€å¤§å€¼</p>
                </div>
              </div>

              <div class="function-item">
                <div class="function-header">
                  <span class="function-name">IF</span>
                  <span class="function-desc">æ¡ä»¶åˆ¤æ–­</span>
                </div>
                <div class="function-example">
                  <code>=IF(A1>60,"åŠæ ¼","ä¸åŠæ ¼")</code>
                  <p>å¦‚æœ A1 å¤§äº 60 æ˜¾ç¤º"åŠæ ¼"ï¼Œå¦åˆ™æ˜¾ç¤º"ä¸åŠæ ¼"</p>
                </div>
              </div>

              <div class="function-item">
                <div class="function-header">
                  <span class="function-name">VLOOKUP</span>
                  <span class="function-desc">å‚ç›´æŸ¥æ‰¾</span>
                </div>
                <div class="function-example">
                  <code>=VLOOKUP(E1,A1:D10,3,0)</code>
                  <p>åœ¨ A1:D10 ä¸­æŸ¥æ‰¾ E1 çš„å€¼ï¼Œè¿”å›ç¬¬3åˆ—çš„æ•°æ®</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ç« èŠ‚4: æ ¼å¼åŒ– -->
        <div v-if="currentSection === 'formatting'" class="section">
          <h3>ğŸ¨ æ ¼å¼åŒ–</h3>

          <div class="content-block">
            <h4>1. æ•°å­—æ ¼å¼</h4>
            <ul class="styled-list">
              <li><strong>è´§å¸ï¼š</strong>ï¿¥1,234.56</li>
              <li><strong>ç™¾åˆ†æ¯”ï¼š</strong>45.5%</li>
              <li><strong>æ—¥æœŸï¼š</strong>2024-01-15 æˆ– 2024å¹´1æœˆ15æ—¥</li>
              <li><strong>è‡ªå®šä¹‰ï¼š</strong>å³é”® â†’ è®¾ç½®å•å…ƒæ ¼æ ¼å¼ â†’ è‡ªå®šä¹‰</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>2. å­—ä½“å’Œé¢œè‰²</h4>
            <div class="format-grid">
              <div class="format-card">
                <span class="format-icon">ğŸ”¤</span>
                <p>å­—ä½“ã€å¤§å°ã€é¢œè‰²</p>
              </div>
              <div class="format-card">
                <span class="format-icon"><strong>B</strong></span>
                <p>åŠ ç²— (Ctrl+B)</p>
              </div>
              <div class="format-card">
                <span class="format-icon"><em>I</em></span>
                <p>æ–œä½“ (Ctrl+I)</p>
              </div>
              <div class="format-card">
                <span class="format-icon"><u>U</u></span>
                <p>ä¸‹åˆ’çº¿ (Ctrl+U)</p>
              </div>
            </div>
          </div>

          <div class="content-block">
            <h4>3. å•å…ƒæ ¼è¾¹æ¡†å’Œå¡«å……</h4>
            <ul class="styled-list">
              <li>é€‰ä¸­å•å…ƒæ ¼ â†’ å¼€å§‹ â†’ è¾¹æ¡† â†’ é€‰æ‹©è¾¹æ¡†æ ·å¼</li>
              <li>å¡«å……é¢œè‰²ï¼šé€‰ä¸­ â†’ å¡«å……é¢œè‰²å›¾æ ‡ â†’ é€‰æ‹©é¢œè‰²</li>
              <li>åˆå¹¶å•å…ƒæ ¼ï¼šé€‰ä¸­å¤šä¸ªå•å…ƒæ ¼ â†’ åˆå¹¶åå±…ä¸­</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>4. æ¡ä»¶æ ¼å¼</h4>
            <p>æ ¹æ®å•å…ƒæ ¼çš„å€¼è‡ªåŠ¨åº”ç”¨æ ¼å¼ï¼š</p>
            <ul class="styled-list">
              <li>çªå‡ºæ˜¾ç¤ºå•å…ƒæ ¼è§„åˆ™ï¼ˆå¤§äºã€å°äºã€ç­‰äºï¼‰</li>
              <li>æ•°æ®æ¡ï¼šç”¨æ¡å½¢å›¾æ˜¾ç¤ºæ•°å€¼å¤§å°</li>
              <li>è‰²é˜¶ï¼šç”¨é¢œè‰²æ¸å˜æ˜¾ç¤ºæ•°å€¼å¤§å°</li>
              <li>å›¾æ ‡é›†ï¼šç”¨å›¾æ ‡è¡¨ç¤ºæ•°å€¼é«˜ä½</li>
            </ul>
          </div>
        </div>

        <!-- ç« èŠ‚5: å›¾è¡¨ -->
        <div v-if="currentSection === 'charts'" class="section">
          <h3>ğŸ“Š å›¾è¡¨</h3>

          <div class="content-block">
            <h4>åˆ›å»ºå›¾è¡¨æ­¥éª¤</h4>
            <div class="steps-list">
              <div class="step-item">
                <span class="step-number">1</span>
                <div class="step-content">
                  <h5>é€‰æ‹©æ•°æ®</h5>
                  <p>é€‰ä¸­è¦åˆ¶ä½œå›¾è¡¨çš„æ•°æ®åŒºåŸŸ</p>
                </div>
              </div>
              <div class="step-item">
                <span class="step-number">2</span>
                <div class="step-content">
                  <h5>æ’å…¥å›¾è¡¨</h5>
                  <p>æ’å…¥ â†’ å›¾è¡¨ â†’ é€‰æ‹©å›¾è¡¨ç±»å‹</p>
                </div>
              </div>
              <div class="step-item">
                <span class="step-number">3</span>
                <div class="step-content">
                  <h5>è‡ªå®šä¹‰</h5>
                  <p>ä¿®æ”¹æ ‡é¢˜ã€é¢œè‰²ã€æ ‡ç­¾ç­‰</p>
                </div>
              </div>
            </div>
          </div>

          <div class="content-block">
            <h4>å¸¸ç”¨å›¾è¡¨ç±»å‹</h4>
            <div class="chart-grid">
              <div class="chart-card">
                <div class="chart-icon">ğŸ“ˆ</div>
                <h5>æŸ±çŠ¶å›¾</h5>
                <p>æ¯”è¾ƒä¸åŒç±»åˆ«çš„æ•°æ®</p>
              </div>
              <div class="chart-card">
                <div class="chart-icon">ğŸ“‰</div>
                <h5>æŠ˜çº¿å›¾</h5>
                <p>æ˜¾ç¤ºè¶‹åŠ¿å’Œå˜åŒ–</p>
              </div>
              <div class="chart-card">
                <div class="chart-icon">ğŸ¥§</div>
                <h5>é¥¼å›¾</h5>
                <p>æ˜¾ç¤ºå„éƒ¨åˆ†å æ¯”</p>
              </div>
              <div class="chart-card">
                <div class="chart-icon">ğŸ“Š</div>
                <h5>æ¡å½¢å›¾</h5>
                <p>æ¨ªå‘æ¯”è¾ƒæ•°æ®</p>
              </div>
              <div class="chart-card">
                <div class="chart-icon">âš«</div>
                <h5>æ•£ç‚¹å›¾</h5>
                <p>æ˜¾ç¤ºä¸¤ä¸ªå˜é‡çš„å…³ç³»</p>
              </div>
              <div class="chart-card">
                <div class="chart-icon">ğŸ“Š</div>
                <h5>é¢ç§¯å›¾</h5>
                <p>æ˜¾ç¤ºæ•°é‡éšæ—¶é—´çš„å˜åŒ–</p>
              </div>
            </div>
          </div>
        </div>

        <!-- ç« èŠ‚6: æ•°æ®å¤„ç† -->
        <div v-if="currentSection === 'data'" class="section">
          <h3>ğŸ” æ•°æ®å¤„ç†</h3>

          <div class="content-block">
            <h4>1. æ’åº</h4>
            <ul class="styled-list">
              <li>é€‰ä¸­æ•°æ®åŒºåŸŸ â†’ æ•°æ® â†’ æ’åº</li>
              <li>å¿«é€Ÿæ’åºï¼šé€‰ä¸­åˆ— â†’ å³é”® â†’ æ’åºï¼ˆå‡åº/é™åºï¼‰</li>
              <li>å¤šåˆ—æ’åºï¼šå¯è®¾ç½®ä¸»è¦æ’åºå’Œæ¬¡è¦æ’åºæ¡ä»¶</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>2. ç­›é€‰</h4>
            <div class="tips-box">
              <p><strong>è‡ªåŠ¨ç­›é€‰ï¼š</strong>é€‰ä¸­æ•°æ® â†’ æ•°æ® â†’ ç­›é€‰ï¼ˆæˆ– Ctrl+Shift+Lï¼‰</p>
              <p>ç‚¹å‡»åˆ—æ ‡é¢˜çš„ä¸‹æ‹‰ç®­å¤´ï¼Œå¯ä»¥ï¼š</p>
              <ul class="styled-list">
                <li>é€‰æ‹©ç‰¹å®šå€¼è¿›è¡Œç­›é€‰</li>
                <li>æŒ‰é¢œè‰²ç­›é€‰</li>
                <li>æŒ‰æ¡ä»¶ç­›é€‰ï¼ˆå¤§äºã€å°äºã€ç­‰äºç­‰ï¼‰</li>
                <li>æ–‡æœ¬ç­›é€‰ï¼ˆåŒ…å«ã€å¼€å¤´ä¸ºã€ç»“å°¾ä¸ºç­‰ï¼‰</li>
              </ul>
            </div>
          </div>

          <div class="content-block">
            <h4>3. åˆ é™¤é‡å¤é¡¹</h4>
            <p>é€‰ä¸­æ•°æ® â†’ æ•°æ® â†’ åˆ é™¤é‡å¤é¡¹ â†’ é€‰æ‹©è¦æ£€æŸ¥çš„åˆ—</p>
          </div>

          <div class="content-block">
            <h4>4. æ•°æ®éªŒè¯</h4>
            <p>é™åˆ¶å•å…ƒæ ¼ä¸­å¯ä»¥è¾“å…¥çš„æ•°æ®ç±»å‹ï¼š</p>
            <ul class="styled-list">
              <li>é€‰ä¸­å•å…ƒæ ¼ â†’ æ•°æ® â†’ æ•°æ®éªŒè¯</li>
              <li>å¯è®¾ç½®ï¼šæ•´æ•°ã€å°æ•°ã€æ—¥æœŸã€åˆ—è¡¨ç­‰</li>
              <li>å¯è®¾ç½®è¾“å…¥æç¤ºå’Œé”™è¯¯æç¤º</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>5. åˆ†åˆ—</h4>
            <p>å°†ä¸€åˆ—æ•°æ®æŒ‰åˆ†éš”ç¬¦æ‹†åˆ†æˆå¤šåˆ—ï¼š</p>
            <p>é€‰ä¸­æ•°æ® â†’ æ•°æ® â†’ åˆ†åˆ— â†’ é€‰æ‹©åˆ†éš”ç¬¦ï¼ˆå¦‚é€—å·ã€ç©ºæ ¼ç­‰ï¼‰</p>
          </div>
        </div>

        <!-- ç« èŠ‚7: å®ç”¨æŠ€å·§ -->
        <div v-if="currentSection === 'tips'" class="section">
          <h3>ğŸ’¡ å®ç”¨æŠ€å·§</h3>

          <div class="content-block">
            <h4>1. å¿«æ·é”®å¤§å…¨</h4>
            <div class="shortcut-grid">
              <div class="shortcut-item">
                <kbd>Ctrl + N</kbd>
                <span>æ–°å»ºå·¥ä½œç°¿</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + S</kbd>
                <span>ä¿å­˜</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + F</kbd>
                <span>æŸ¥æ‰¾</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + H</kbd>
                <span>æ›¿æ¢</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + A</kbd>
                <span>å…¨é€‰</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + Home</kbd>
                <span>å›åˆ°A1</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + End</kbd>
                <span>åˆ°æœ€åå•å…ƒæ ¼</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + Page Up/Down</kbd>
                <span>åˆ‡æ¢å·¥ä½œè¡¨</span>
              </div>
              <div class="shortcut-item">
                <kbd>Alt + =</kbd>
                <span>è‡ªåŠ¨æ±‚å’Œ</span>
              </div>
              <div class="shortcut-item">
                <kbd>F4</kbd>
                <span>é‡å¤ä¸Šä¸€æ­¥/åˆ‡æ¢å¼•ç”¨</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + D</kbd>
                <span>å‘ä¸‹å¡«å……</span>
              </div>
              <div class="shortcut-item">
                <kbd>Ctrl + R</kbd>
                <span>å‘å³å¡«å……</span>
              </div>
            </div>
          </div>

          <div class="content-block">
            <h4>2. å•å…ƒæ ¼å¼•ç”¨</h4>
            <div class="reference-types">
              <div class="ref-item">
                <h5>ç›¸å¯¹å¼•ç”¨: A1</h5>
                <p>å¤åˆ¶å…¬å¼æ—¶ï¼Œå¼•ç”¨ä¼šè‡ªåŠ¨è°ƒæ•´</p>
              </div>
              <div class="ref-item">
                <h5>ç»å¯¹å¼•ç”¨: $A$1</h5>
                <p>å¤åˆ¶å…¬å¼æ—¶ï¼Œå¼•ç”¨ä¿æŒä¸å˜</p>
              </div>
              <div class="ref-item">
                <h5>æ··åˆå¼•ç”¨: $A1 æˆ– A$1</h5>
                <p>é”å®šè¡Œæˆ–åˆ—ï¼Œå¦ä¸€ä¸ªå¯ä»¥å˜åŒ–</p>
              </div>
            </div>
            <div class="tips-box">
              <p><strong>æŠ€å·§ï¼š</strong>æŒ‰ <kbd>F4</kbd> å¯ä»¥å¿«é€Ÿåˆ‡æ¢å¼•ç”¨ç±»å‹</p>
            </div>
          </div>

          <div class="content-block">
            <h4>3. å†»ç»“çª—æ ¼</h4>
            <p>å›ºå®šè¡Œæˆ–åˆ—ï¼Œæ»šåŠ¨æ—¶ä¿æŒå¯è§ï¼š</p>
            <ul class="styled-list">
              <li>å†»ç»“é¦–è¡Œï¼šè§†å›¾ â†’ å†»ç»“çª—æ ¼ â†’ å†»ç»“é¦–è¡Œ</li>
              <li>å†»ç»“é¦–åˆ—ï¼šè§†å›¾ â†’ å†»ç»“çª—æ ¼ â†’ å†»ç»“é¦–åˆ—</li>
              <li>è‡ªå®šä¹‰å†»ç»“ï¼šé€‰ä¸­å•å…ƒæ ¼ â†’ å†»ç»“çª—æ ¼ï¼ˆä¼šå†»ç»“è¯¥å•å…ƒæ ¼ä¸Šæ–¹å’Œå·¦ä¾§ï¼‰</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>4. åç§°ç®¡ç†å™¨</h4>
            <p>ä¸ºå•å…ƒæ ¼æˆ–åŒºåŸŸå‘½åï¼Œæ–¹ä¾¿åœ¨å…¬å¼ä¸­ä½¿ç”¨ï¼š</p>
            <ul class="styled-list">
              <li>é€‰ä¸­åŒºåŸŸ â†’ åç§°æ¡†ï¼ˆå·¦ä¸Šè§’ï¼‰è¾“å…¥åç§°</li>
              <li>åœ¨å…¬å¼ä¸­å¯ç›´æ¥ä½¿ç”¨åç§°ï¼Œå¦‚ =SUM(é”€å”®é¢)</li>
            </ul>
          </div>

          <div class="content-block">
            <h4>5. æ‰¹æ³¨å’Œå¤‡æ³¨</h4>
            <ul class="styled-list">
              <li>å³é”®å•å…ƒæ ¼ â†’ æ’å…¥æ‰¹æ³¨/å¤‡æ³¨</li>
              <li>æ‰¹æ³¨ç”¨äºåä½œè®¨è®º</li>
              <li>å¤‡æ³¨ç”¨äºæ·»åŠ è¯´æ˜ä¿¡æ¯</li>
            </ul>
          </div>
        </div>

        <!-- ç« èŠ‚8: ç»ƒä¹ ç¤ºä¾‹ -->
        <div v-if="currentSection === 'practice'" class="section">
          <h3>ğŸ“ ç»ƒä¹ ç¤ºä¾‹</h3>

          <div class="content-block">
            <h4>ç»ƒä¹ 1ï¼šåˆ›å»ºä¸ªäººé¢„ç®—è¡¨</h4>
            <div class="practice-box">
              <p><strong>ç›®æ ‡ï¼š</strong>åˆ›å»ºä¸€ä¸ªç®€å•çš„æœˆåº¦é¢„ç®—è¡¨</p>
              <ol class="styled-list">
                <li>åˆ›å»ºè¡¨å¤´ï¼šé¡¹ç›®ã€é¢„ç®—é‡‘é¢ã€å®é™…æ”¯å‡ºã€å·®é¢</li>
                <li>è¾“å…¥å‡ é¡¹æ”¯å‡ºï¼ˆå¦‚æˆ¿ç§Ÿã€é¤é¥®ã€äº¤é€šç­‰ï¼‰</li>
                <li>ä½¿ç”¨å…¬å¼è®¡ç®—å·®é¢ï¼š=é¢„ç®—é‡‘é¢-å®é™…æ”¯å‡º</li>
                <li>ä½¿ç”¨ SUM å‡½æ•°è®¡ç®—æ€»è®¡</li>
                <li>åº”ç”¨æ ¼å¼åŒ–ç¾åŒ–è¡¨æ ¼</li>
                <li>ä½¿ç”¨æ¡ä»¶æ ¼å¼ï¼šè¶…æ”¯çš„é¡¹ç›®æ ‡çº¢</li>
              </ol>
            </div>
          </div>

          <div class="content-block">
            <h4>ç»ƒä¹ 2ï¼šæˆç»©ç»Ÿè®¡è¡¨</h4>
            <div class="practice-box">
              <p><strong>ç›®æ ‡ï¼š</strong>ç»Ÿè®¡å­¦ç”Ÿæˆç»©å¹¶è®¡ç®—ç­‰çº§</p>
              <ol class="styled-list">
                <li>åˆ›å»ºè¡¨å¤´ï¼šå§“åã€è¯­æ–‡ã€æ•°å­¦ã€è‹±è¯­ã€æ€»åˆ†ã€å¹³å‡åˆ†ã€ç­‰çº§</li>
                <li>è¾“å…¥å‡ ä¸ªå­¦ç”Ÿçš„æˆç»©æ•°æ®</li>
                <li>ä½¿ç”¨å…¬å¼è®¡ç®—æ€»åˆ†å’Œå¹³å‡åˆ†</li>
                <li>ä½¿ç”¨ IF å‡½æ•°åˆ¤æ–­ç­‰çº§ï¼š
                  <div class="code-example">
                    =IF(å¹³å‡åˆ†>=90,"ä¼˜ç§€",IF(å¹³å‡åˆ†>=80,"è‰¯å¥½",IF(å¹³å‡åˆ†>=60,"åŠæ ¼","ä¸åŠæ ¼")))
                  </div>
                </li>
                <li>ä½¿ç”¨ MAXã€MINã€AVERAGE å‡½æ•°ç»Ÿè®¡å…¨ç­æˆç»©</li>
                <li>åˆ›å»ºæŸ±çŠ¶å›¾å±•ç¤ºå„ç§‘å¹³å‡åˆ†</li>
              </ol>
            </div>
          </div>

          <div class="content-block">
            <h4>ç»ƒä¹ 3ï¼šé”€å”®æ•°æ®åˆ†æ</h4>
            <div class="practice-box">
              <p><strong>ç›®æ ‡ï¼š</strong>åˆ†æäº§å“é”€å”®æ•°æ®</p>
              <ol class="styled-list">
                <li>åˆ›å»ºè¡¨å¤´ï¼šæ—¥æœŸã€äº§å“ã€æ•°é‡ã€å•ä»·ã€é‡‘é¢</li>
                <li>è¾“å…¥å¤šæ¡é”€å”®è®°å½•</li>
                <li>ä½¿ç”¨å…¬å¼è®¡ç®—é‡‘é¢ï¼š=æ•°é‡*å•ä»·</li>
                <li>ä½¿ç”¨è‡ªåŠ¨ç­›é€‰æŸ¥çœ‹ç‰¹å®šäº§å“çš„é”€å”®</li>
                <li>ä½¿ç”¨æ’åºæ‰¾å‡ºé”€å”®é¢æœ€é«˜çš„è®°å½•</li>
                <li>åˆ›å»ºé¥¼å›¾æ˜¾ç¤ºå„äº§å“é”€å”®å æ¯”</li>
                <li>åˆ›å»ºæŠ˜çº¿å›¾æ˜¾ç¤ºé”€å”®è¶‹åŠ¿</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- å®Œæˆæ ‡è®°æŒ‰é’® -->
        <div class="section-actions">
          <button
            class="complete-btn"
            @click="toggleComplete(currentSection)"
            :class="{ completed: completedSections.includes(currentSection) }"
          >
            {{ completedSections.includes(currentSection) ? 'âœ“ å·²å®Œæˆ' : 'æ ‡è®°ä¸ºå·²å®Œæˆ' }}
          </button>

          <div class="navigation-buttons">
            <button
              class="nav-btn prev"
              @click="previousSection"
              :disabled="currentSectionIndex === 0"
            >
              â† ä¸Šä¸€ç« 
            </button>
            <button
              class="nav-btn next"
              @click="nextSection"
              :disabled="currentSectionIndex === sections.length - 1"
            >
              ä¸‹ä¸€ç«  â†’
            </button>
          </div>
        </div>
      </main>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue';

const currentSection = ref('intro');
const completedSections = ref([]);

const sections = [
  { id: 'intro', icon: 'ğŸ¯', title: 'Excel ç®€ä»‹' },
  { id: 'basics', icon: 'âŒ¨ï¸', title: 'åŸºæœ¬æ“ä½œ' },
  { id: 'formulas', icon: 'ğŸ”¢', title: 'å…¬å¼å’Œå‡½æ•°' },
  { id: 'formatting', icon: 'ğŸ¨', title: 'æ ¼å¼åŒ–' },
  { id: 'charts', icon: 'ğŸ“Š', title: 'å›¾è¡¨' },
  { id: 'data', icon: 'ğŸ”', title: 'æ•°æ®å¤„ç†' },
  { id: 'tips', icon: 'ğŸ’¡', title: 'å®ç”¨æŠ€å·§' },
  { id: 'practice', icon: 'ğŸ“', title: 'ç»ƒä¹ ç¤ºä¾‹' }
];

const currentSectionIndex = computed(() => {
  return sections.findIndex(s => s.id === currentSection.value);
});

const completedCount = computed(() => completedSections.value.length);

const progress = computed(() => {
  return Math.round((completedCount.value / sections.length) * 100);
});

const toggleComplete = (sectionId) => {
  const index = completedSections.value.indexOf(sectionId);
  if (index > -1) {
    completedSections.value.splice(index, 1);
  } else {
    completedSections.value.push(sectionId);
  }
};

const previousSection = () => {
  if (currentSectionIndex.value > 0) {
    currentSection.value = sections[currentSectionIndex.value - 1].id;
  }
};

const nextSection = () => {
  if (currentSectionIndex.value < sections.length - 1) {
    currentSection.value = sections[currentSectionIndex.value + 1].id;
  }
};
</script>

<style scoped>
.excel-guide {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  background: #1a1a1a;
  color: #e0e0e0;
}

.guide-header {
  padding: 30px;
  background: linear-gradient(135deg, #1e7e34 0%, #28a745 100%);
  text-align: center;
  border-bottom: 3px solid #28a745;
}

.guide-header h2 {
  margin: 0;
  font-size: 32px;
  color: white;
  font-weight: 700;
}

.subtitle {
  margin: 10px 0 0 0;
  font-size: 16px;
  color: rgba(255, 255, 255, 0.9);
}

.guide-content {
  flex: 1;
  display: flex;
  overflow: hidden;
}

/* ä¾§è¾¹æ  */
.sidebar {
  width: 280px;
  background: #2d2d2d;
  border-right: 1px solid #444;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
}

.nav-menu {
  padding: 20px 10px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 12px;
  width: 100%;
  padding: 14px 16px;
  margin-bottom: 8px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 8px;
  color: #999;
  font-size: 15px;
  cursor: pointer;
  transition: all 0.3s;
  text-align: left;
}

.nav-item:hover {
  background: #333;
  border-color: #28a745;
  color: #e0e0e0;
}

.nav-item.active {
  background: linear-gradient(135deg, #1e7e34 0%, #28a745 100%);
  border-color: #28a745;
  color: white;
  font-weight: 600;
}

.nav-item .icon {
  font-size: 20px;
}

.nav-item .text {
  flex: 1;
}

/* è¿›åº¦éƒ¨åˆ† */
.progress-section {
  padding: 20px;
  margin-top: auto;
  border-top: 1px solid #444;
}

.progress-section h4 {
  margin: 0 0 15px 0;
  font-size: 14px;
  color: #999;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: #1a1a1a;
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 10px;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #1e7e34 0%, #28a745 100%);
  transition: width 0.3s;
}

.progress-text {
  margin: 0;
  font-size: 13px;
  color: #999;
  text-align: center;
}

/* ä¸»å†…å®¹åŒº */
.main-content {
  flex: 1;
  padding: 30px;
  overflow-y: auto;
}

.section h3 {
  margin: 0 0 25px 0;
  font-size: 28px;
  color: #28a745;
  padding-bottom: 15px;
  border-bottom: 2px solid #28a745;
}

.content-block {
  margin-bottom: 30px;
  padding: 20px;
  background: #2d2d2d;
  border-radius: 10px;
  border: 1px solid #444;
}

.content-block h4 {
  margin: 0 0 15px 0;
  font-size: 20px;
  color: #28a745;
}

.content-block p {
  margin: 0 0 10px 0;
  line-height: 1.6;
  color: #ccc;
}

/* åŠŸèƒ½å¡ç‰‡ç½‘æ ¼ */
.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 20px;
}

.feature-card {
  padding: 20px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 8px;
  text-align: center;
  transition: transform 0.3s;
}

.feature-card:hover {
  transform: translateY(-5px);
  border-color: #28a745;
}

.feature-icon {
  font-size: 36px;
  margin-bottom: 10px;
}

.feature-card h4 {
  margin: 10px 0 5px 0;
  font-size: 16px;
  color: #28a745;
}

.feature-card p {
  margin: 0;
  font-size: 13px;
  color: #999;
}

/* åˆ—è¡¨æ ·å¼ */
.styled-list {
  list-style: none;
  padding: 0;
  margin: 10px 0;
}

.styled-list li {
  padding: 10px 0 10px 30px;
  position: relative;
  line-height: 1.6;
  color: #ccc;
}

.styled-list li::before {
  content: "â–¸";
  position: absolute;
  left: 10px;
  color: #28a745;
  font-weight: bold;
}

/* æç¤ºæ¡† */
.tips-box {
  padding: 15px;
  background: #1a1a1a;
  border-left: 4px solid #28a745;
  border-radius: 5px;
}

.tips-box p {
  margin: 8px 0;
}

/* ä»£ç ç¤ºä¾‹ */
.code-example {
  padding: 15px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 5px;
  font-family: 'Courier New', monospace;
  margin: 10px 0;
}

.code-example code {
  color: #28a745;
  font-size: 14px;
}

/* è¿ç®—ç¬¦ç½‘æ ¼ */
.operator-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 10px;
  margin-top: 15px;
}

.operator-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 15px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 8px;
}

.operator-item .op {
  font-size: 28px;
  font-weight: bold;
  color: #28a745;
  margin-bottom: 8px;
}

.operator-item span:last-child {
  font-size: 13px;
  color: #999;
}

/* å‡½æ•°åˆ—è¡¨ */
.function-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.function-item {
  padding: 15px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 8px;
}

.function-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 10px;
}

.function-name {
  font-family: 'Courier New', monospace;
  font-size: 16px;
  font-weight: bold;
  color: #28a745;
}

.function-desc {
  color: #999;
  font-size: 14px;
}

.function-example code {
  display: block;
  padding: 10px;
  background: #2d2d2d;
  border-radius: 5px;
  color: #28a745;
  margin-bottom: 8px;
}

.function-example p {
  margin: 0;
  font-size: 13px;
  color: #999;
}

/* æ ¼å¼åŒ–ç½‘æ ¼ */
.format-grid,
.chart-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.format-card,
.chart-card {
  padding: 20px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 8px;
  text-align: center;
}

.format-icon,
.chart-icon {
  font-size: 32px;
  margin-bottom: 10px;
  display: block;
}

.chart-card h5 {
  margin: 10px 0 5px 0;
  color: #28a745;
}

.chart-card p {
  margin: 0;
  font-size: 13px;
  color: #999;
}

/* æ­¥éª¤åˆ—è¡¨ */
.steps-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 15px;
}

.step-item {
  display: flex;
  gap: 15px;
  padding: 15px;
  background: #1a1a1a;
  border-radius: 8px;
}

.step-number {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #28a745;
  color: white;
  border-radius: 50%;
  font-weight: bold;
  font-size: 18px;
  flex-shrink: 0;
}

.step-content h5 {
  margin: 0 0 5px 0;
  color: #28a745;
}

.step-content p {
  margin: 0;
  color: #999;
}

/* å¿«æ·é”®ç½‘æ ¼ */
.shortcut-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 12px;
  margin-top: 15px;
}

.shortcut-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 15px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 5px;
}

kbd {
  padding: 4px 8px;
  background: #2d2d2d;
  border: 1px solid #555;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  color: #28a745;
}

.shortcut-item span {
  color: #999;
  font-size: 13px;
}

/* å¼•ç”¨ç±»å‹ */
.reference-types {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.ref-item {
  padding: 15px;
  background: #1a1a1a;
  border: 1px solid #444;
  border-radius: 8px;
}

.ref-item h5 {
  margin: 0 0 8px 0;
  color: #28a745;
  font-family: 'Courier New', monospace;
}

.ref-item p {
  margin: 0;
  font-size: 13px;
  color: #999;
}

/* ç»ƒä¹ æ¡† */
.practice-box {
  padding: 20px;
  background: #1a1a1a;
  border: 2px solid #28a745;
  border-radius: 8px;
  margin-top: 15px;
}

.practice-box p strong {
  color: #28a745;
}

.practice-box ol {
  margin: 15px 0 0 20px;
  color: #ccc;
}

.practice-box ol li {
  margin-bottom: 10px;
  line-height: 1.6;
}

/* ç« èŠ‚æ“ä½œæŒ‰é’® */
.section-actions {
  margin-top: 40px;
  padding-top: 30px;
  border-top: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 20px;
}

.complete-btn {
  padding: 12px 30px;
  background: #1a1a1a;
  color: #28a745;
  border: 2px solid #28a745;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
}

.complete-btn:hover {
  background: #28a745;
  color: white;
}

.complete-btn.completed {
  background: #28a745;
  color: white;
}

.navigation-buttons {
  display: flex;
  gap: 15px;
}

.nav-btn {
  padding: 12px 24px;
  background: #2d2d2d;
  color: #e0e0e0;
  border: 1px solid #444;
  border-radius: 8px;
  font-size: 15px;
  cursor: pointer;
  transition: all 0.3s;
}

.nav-btn:hover:not(:disabled) {
  background: #28a745;
  border-color: #28a745;
  color: white;
}

.nav-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* å“åº”å¼ */
@media (max-width: 1024px) {
  .sidebar {
    width: 240px;
  }

  .main-content {
    padding: 20px;
  }

  .feature-grid,
  .format-grid,
  .chart-grid {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  }
}

@media (max-width: 768px) {
  .guide-content {
    flex-direction: column;
  }

  .sidebar {
    width: 100%;
    max-height: 200px;
    border-right: none;
    border-bottom: 1px solid #444;
  }

  .nav-menu {
    display: flex;
    overflow-x: auto;
    padding: 10px;
  }

  .nav-item {
    min-width: 150px;
    margin-right: 8px;
    margin-bottom: 0;
  }

  .progress-section {
    display: none;
  }

  .section-actions {
    flex-direction: column;
    gap: 15px;
  }

  .navigation-buttons {
    width: 100%;
  }

  .nav-btn {
    flex: 1;
  }
}
</style>
